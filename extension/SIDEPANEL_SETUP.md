# Nexus Extension - Side Panel è®¾ç½®æŒ‡å—

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

Nexus æµè§ˆå™¨æ‰©å±•ç°åœ¨ä½¿ç”¨ **Side Panel** ç•Œé¢ï¼Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼š

- âœ… ä¸ web ç«¯å…±äº«ç™»å½•çŠ¶æ€ (localhost:3000)
- âœ… æ”¯æŒå¤šç§ç™»å½•æ–¹å¼
- âœ… AI æ™ºèƒ½æ‘˜è¦å’Œé¡µé¢ä¿å­˜åŠŸèƒ½
- âœ… è‡ªåŠ¨çŠ¶æ€åŒæ­¥

## ğŸ“ è¿è¡Œç›®å½•

**é‡è¦æé†’**ï¼šæ‰€æœ‰æ‰©å±•ç›¸å…³çš„å‘½ä»¤éƒ½å¿…é¡»åœ¨ `extension/` ç›®å½•ä¸‹è¿è¡Œï¼

```bash
# è¿›å…¥æ‰©å±•ç›®å½•
cd extension

# ç„¶åè¿è¡Œä»»ä½•æ‰©å±•ç›¸å…³å‘½ä»¤
pnpm run dev:local
pnpm run build:local
```

## ğŸš€ å®‰è£…æ­¥éª¤

### 1. æ„å»ºæ‰©å±•
```bash
# ç¡®ä¿åœ¨ extension/ ç›®å½•ä¸‹
cd extension

# æœ¬åœ°å¼€å‘ç‰ˆæœ¬
pnpm run build:local  

# ç”Ÿäº§ç‰ˆæœ¬
pnpm run build:prod   
```

### 2. åŠ è½½åˆ° Chrome
1. æ‰“å¼€ Chrome æµè§ˆå™¨
2. è®¿é—® `chrome://extensions/`
3. å¼€å¯å³ä¸Šè§’çš„ "å¼€å‘è€…æ¨¡å¼"
4. ç‚¹å‡» "åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº"
5. é€‰æ‹© `extension/build/chrome-mv3-prod` ç›®å½•

### 3. æ¿€æ´» Side Panel
1. å®‰è£…åç‚¹å‡»å·¥å…·æ ä¸­çš„ Nexus å›¾æ ‡
2. æˆ–è€…å³é”®ç‚¹å‡»å›¾æ ‡é€‰æ‹© "åœ¨ä¾§è¾¹æ ä¸­æ‰“å¼€"
3. æ‰©å±•ä¼šåœ¨æµè§ˆå™¨å³ä¾§æ‰“å¼€ Side Panel

## ğŸ” ç™»å½•æ–¹å¼

### æ–¹å¼ 1: ä»ç½‘é¡µåŒæ­¥ (æ¨è)
1. å…ˆåœ¨ `http://localhost:3000` ç™»å½• web ç«¯
2. åœ¨ Side Panel ä¸­ç‚¹å‡» "ä»ç½‘é¡µåŒæ­¥ç™»å½•çŠ¶æ€"
3. è‡ªåŠ¨è·å–ç™»å½•çŠ¶æ€

### æ–¹å¼ 2: ç›´æ¥ç™»å½•
1. åœ¨ Side Panel ä¸­è¾“å…¥é‚®ç®±å’Œå¯†ç 
2. ç‚¹å‡»ç™»å½•æŒ‰é’®

### æ–¹å¼ 3: è·³è½¬ç½‘é¡µç™»å½•
1. ç‚¹å‡» "åœ¨ç½‘é¡µä¸­ç™»å½•" æŒ‰é’®
2. è·³è½¬åˆ° web ç«¯ç™»å½•é¡µé¢
3. ç™»å½•åå›åˆ°æ‰©å±•è‡ªåŠ¨åŒæ­¥

## ğŸ“± ä¸»è¦åŠŸèƒ½

### ç™»å½•ååŠŸèƒ½
- **æ‰“å¼€ä»ªè¡¨æ¿**: è·³è½¬åˆ° web ç«¯ä¸»é¡µ
- **å†…å®¹åº“**: è®¿é—®å·²ä¿å­˜çš„å†…å®¹
- **ä¿å­˜é¡µé¢**: ä¸€é”®ä¿å­˜å½“å‰é¡µé¢åˆ°å†…å®¹åº“
- **AI æ€»ç»“**: æ™ºèƒ½ç”Ÿæˆå½“å‰é¡µé¢æ‘˜è¦

### æ™ºèƒ½åŠŸèƒ½
- è‡ªåŠ¨æå–é¡µé¢æ ¸å¿ƒå†…å®¹
- AI æ‘˜è¦ç”Ÿæˆå¹¶åœ¨æ¨¡æ€æ¡†ä¸­æ˜¾ç¤º
- é¡µé¢ä¿å­˜çŠ¶æ€é€šçŸ¥
- ç™»å½•çŠ¶æ€è‡ªåŠ¨åŒæ­¥

## ğŸ”§ å¼€å‘æ¨¡å¼

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
# ç¡®ä¿åœ¨ extension/ ç›®å½•ä¸‹
cd extension
pnpm run dev:local
```

### çƒ­é‡è½½
å¼€å‘æ¨¡å¼æ”¯æŒçƒ­é‡è½½ï¼Œä¿®æ”¹ä»£ç åï¼š
1. ä¿å­˜æ–‡ä»¶
2. åœ¨ `chrome://extensions/` ä¸­ç‚¹å‡»åˆ·æ–°æŒ‰é’®
3. æˆ–è€…é‡æ–°åŠ è½½æ‰©å±•

## ğŸŒ ç«¯å£é…ç½®

- **Backend API**: `http://localhost:8000`
- **Frontend Web**: `http://localhost:3000`
- **æ‰©å±•ä¼šè‡ªåŠ¨è¿æ¥è¿™äº›æœåŠ¡**

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **`ERR_PNPM_NO_IMPORTER_MANIFEST_FOUND` é”™è¯¯**
   - âœ… ç¡®ä¿åœ¨ `extension/` ç›®å½•ä¸‹è¿è¡Œå‘½ä»¤
   - âŒ ä¸è¦åœ¨ä¸»é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œæ‰©å±•å‘½ä»¤

2. **Side Panel ä¸æ˜¾ç¤º**
   - ç¡®è®¤å·²å®‰è£…æ‰©å±•
   - æ£€æŸ¥æ˜¯å¦åœ¨ `chrome://extensions/` ä¸­å¯ç”¨
   - å°è¯•åˆ·æ–°æ‰©å±•

3. **ç™»å½•åŒæ­¥å¤±è´¥**
   - ç¡®è®¤ web ç«¯å·²ç™»å½• (`localhost:3000`)
   - æ£€æŸ¥ cookies æƒé™
   - æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

4. **API è°ƒç”¨å¤±è´¥**
   - ç¡®è®¤åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œ (`localhost:8000`)
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - æŸ¥çœ‹ CSP é…ç½®

### è°ƒè¯•æ–¹æ³•

1. **æŸ¥çœ‹æ‰©å±•æ—¥å¿—**
   - åœ¨ `chrome://extensions/` ä¸­æ‰¾åˆ° Nexus æ‰©å±•
   - ç‚¹å‡» "æ£€æŸ¥è§†å›¾" -> "sidepanel.html"
   - æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º

2. **æ£€æŸ¥æƒé™**
   ```javascript
   // åœ¨æ‰©å±•æ§åˆ¶å°ä¸­
   chrome.permissions.getAll(console.log)
   ```

3. **éªŒè¯å­˜å‚¨**
   ```javascript
   // æ£€æŸ¥æ‰©å±•å­˜å‚¨
   chrome.storage.local.get(null, console.log)
   ```

## ğŸ“‹ æ–‡ä»¶ç»“æ„

```
extension/
â”œâ”€â”€ sidepanel.tsx            # Side Panel å…¥å£
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ SidePanelApp.tsx     # ä¸»åº”ç”¨ç»„ä»¶ (é‡å‘½å)
â”‚   â”œâ”€â”€ LoginForm.tsx        # ç™»å½•è¡¨å•
â”‚   â””â”€â”€ DashboardView.tsx    # åŠŸèƒ½é¢æ¿
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ auth.ts              # è®¤è¯é€»è¾‘
â”‚   â”œâ”€â”€ useAuth.ts           # React Hook
â”‚   â””â”€â”€ api.ts               # API è°ƒç”¨
â”œâ”€â”€ contents/
â”‚   â””â”€â”€ page-handler.ts      # å†…å®¹è„šæœ¬
â””â”€â”€ build/
    â””â”€â”€ chrome-mv3-prod/     # æ„å»ºè¾“å‡º
```

## âš™ï¸ æ„å»ºç³»ç»Ÿ

é¡¹ç›®ä½¿ç”¨ **Plasmo æ¡†æ¶**ï¼Œå®ƒæä¾›äº†ï¼š
- âœ… è‡ªåŠ¨åŒ–çš„ Chrome MV3 manifest ç”Ÿæˆ
- âœ… TypeScript å’Œ React æ”¯æŒ
- âœ… çƒ­é‡è½½å¼€å‘ç¯å¢ƒ
- âœ… ä¼˜åŒ–çš„ç”Ÿäº§æ„å»º

~~ä¸å†éœ€è¦è‡ªå®šä¹‰çš„ `build-with-assets.js` è„šæœ¬~~

## ğŸ”„ ä¸ Web ç«¯åŒæ­¥

æ‰©å±•ä¼šè‡ªåŠ¨ç›‘å¬ web ç«¯çš„ç™»å½•çŠ¶æ€å˜åŒ–ï¼š
- åœ¨ web ç«¯ç™»å½• â†’ æ‰©å±•è‡ªåŠ¨åŒæ­¥
- åœ¨ web ç«¯ç™»å‡º â†’ æ‰©å±•è‡ªåŠ¨æ¸…é™¤çŠ¶æ€
- ä½¿ç”¨ç›¸åŒçš„ API å’Œè®¤è¯æœºåˆ¶

è¿™æ ·ç”¨æˆ·åœ¨ä»»ä½•ä¸€ç«¯çš„æ“ä½œéƒ½ä¼šåœ¨å¦ä¸€ç«¯ç”Ÿæ•ˆï¼Œæä¾›æ— ç¼çš„è·¨å¹³å°ä½“éªŒï¼ 